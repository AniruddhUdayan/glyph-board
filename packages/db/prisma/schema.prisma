generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
  id         String   @id @default(uuid())
  email      String   @unique
  password   String
  name       String?
  photo      String?
  room       Room[]
  shapes     Shape[]
}

model Room {
  id         String   @id @default(uuid())
  slug       String   @unique
  createdAt  DateTime @default(now())
  adminId    String
  admin      User     @relation(fields: [adminId], references: [id])
  shapes     Shape[]
}

model Shape {
  id           String   @id @default(uuid())
  roomId       String
  userId       String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  
  // Shape properties
  shapeId      String   // Frontend element ID
  type         String   // rectangle, circle, diamond, arrow, line, pencil, text
  x            Float
  y            Float
  width        Float
  height       Float
  strokeColor  String   @default("#000000")
  fillColor    String   @default("transparent")
  strokeWidth  Float    @default(2)
  opacity      Float    @default(1)
  angle        Float    @default(0)
  
  // Type-specific data stored as JSON
  data         Json?    // For points, text content, etc.
  
  // Relations
  room         Room     @relation(fields: [roomId], references: [id], onDelete: Cascade)
  user         User     @relation(fields: [userId], references: [id])
  
  @@unique([roomId, shapeId])
  @@index([roomId])
  @@index([userId])
}